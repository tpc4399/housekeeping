<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.housekeeping.admin.mapper.CompanyDetailsMapper">
    <update id="updateLogoUrlById">
        UPDATE company_details
        SET logo_url = #{logoUrl}
        WHERE user_id = #{reviserId}
    </update>
    <update id="updateFiveImgUrlByUserId">
        UPDATE company_details
        SET photos = #{imgUrl}
        WHERE user_id = #{reviserId}
    </update>
    <update id="updateById">
        UPDATE company_details
        SET last_reviser_id = #{lastReviserId},
            no_certified_company = #{companyDetailsDTO.noCertifiedCompany},
            company_name = #{companyDetailsDTO.companyName},
            company_size_id = #{companyDetailsDTO.companySizeId},
            address1 = #{companyDetailsDTO.address1},
            address2 = #{companyDetailsDTO.address2},
            address3 = #{companyDetailsDTO.address3},
            address4 = #{companyDetailsDTO.address4},
            service_hotline_prefix = #{companyDetailsDTO.serviceHotlinePrefix},
            service_hotline = #{companyDetailsDTO.serviceHotline},
            email = #{companyDetailsDTO.email},
            web_pages = #{companyDetailsDTO.webPages},
            account_line = #{companyDetailsDTO.accountLine},
            connection_facebook = #{companyDetailsDTO.connectionFacebook},
            connection_instagram = #{companyDetailsDTO.connectionInstagram},
            describes = #{companyDetailsDTO.describes},
            method_payment = #{companyDetailsDTO.methodPayment},
            bank_name = #{companyDetailsDTO.bankName},
            bank_account = #{companyDetailsDTO.bankAccount}
        WHERE id = #{companyDetailsDTO.id}
    </update>
    <select id="getLogoUrlByUserId" resultType="java.lang.String">
        SELECT logo_url
        FROM company_details
        WHERE user_id = #{userId}
    </select>
    <select id="getPhotosByUserId" resultType="java.lang.String">
        SELECT photos
        FROM company_details
        WHERE user_id = #{userId}
    </select>

    <select id="getScaleSwitch" resultType="java.lang.Integer">
        SELECT scale_fee_switch FROM sys_config
    </select>

    <select id="getCollect" resultType="java.lang.Integer">
        SELECT COUNT(id) FROM customer_company WHERE company_id = #{companyId}
    </select>

    <update id="authSuccess">
        UPDATE company_details
        SET is_validate = true, company_name = #{companyName},no_certified_company = #{companyName}
        WHERE id = #{companyId}
    </update>

    <update id="cusUpdateById">
        UPDATE company_details set tokens = #{tokens} + 5 ,is_new = 0 WHERE id = #{id}
    </update>

    <update id="buyTokens">
        UPDATE company_details set tokens = #{tokens} + #{buyTokens} WHERE id = #{id}
    </update>

    <update id="promotion">
         UPDATE company_details set tokens = #{ctokens} - #{tokens} WHERE id = #{companyId}
    </update>
    <update id="updateById2">
        UPDATE company_details
        SET last_reviser_id = #{lastReviserId},
            no_certified_company = #{dto.noCertifiedCompany},
            address1 = #{dto.address1},
            address2 = #{dto.address2},
            address3 = #{dto.address3},
            address4 = #{dto.address4},
            service_hotline_prefix = #{dto.serviceHotlinePrefix},
            service_hotline = #{dto.serviceHotline},
            email = #{dto.email},
            web_pages = #{dto.webPages},
            account_line = #{dto.accountLine},
            connection_facebook = #{dto.connectionFacebook},
            connection_instagram = #{dto.connectionInstagram},
            describes = #{dto.describes},
            method_payment = #{dto.methodPayment},
            photos = #{dto.fivePhotoUrls},
            number = #{dto.number},
            bank_name = #{dto.bankName},
            bank_account = #{dto.bankAccount}
        WHERE id = #{dto.id}
    </update>
</mapper>
